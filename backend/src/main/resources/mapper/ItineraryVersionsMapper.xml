<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.travel.agent.mapper.ItineraryVersionsMapper">

    <insert id="insertJsonb"
            parameterType="com.travel.agent.entity.ItineraryVersions"
            useGeneratedKeys="true"
            keyProperty="id">
        INSERT INTO itinerary_versions
        (
            trip_id,
            version_number,
            snapshot,
            change_description,
            total_cost,
            created_at
        )
        VALUES
        (
            #{tripId},
            #{versionNumber},
            CAST(#{snapshot} AS jsonb),
            #{changeDescription},
            #{totalCost},
            #{createdAt}
        )
    </insert>

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.travel.agent.entity.ItineraryVersions">
        <id column="id" property="id" />
        <result column="trip_id" property="tripId" />
        <result column="version_number" property="versionNumber" />
        <result column="snapshot" property="snapshot" />
        <result column="change_description" property="changeDescription" />
        <result column="total_cost" property="totalCost" />
        <result column="created_at" property="createdAt" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        id, trip_id, version_number, snapshot, change_description, total_cost, created_at
    </sql>

</mapper>
